class Node:
    def __init__(self,dado):
        self.dado=dado
        self.esquerda=None
        self.direita=None

class Arvore:
    def __init__(self):
        self.raiz=None

    def inserir(self,dado):
        novo=Node(dado)
        if self.raiz is None:
            self.raiz=novo
            return
        atual=self.raiz
        while True:
            if dado < atual.dado:
                if atual.esquerda is None:
                    atual.esquerda=novo
                    return
                atual=atual.esquerda
            else:
                if atual.direita is None:
                    atual.direita=novo
                    return
                atual=atual.direita

    def altura(self,no):
        if no==None:
            return 0
        alt_esq=self.altura(no.esquerda)
        alt_dir=self.altura(no.direita)
        if alt_esq>alt_dir:
            return alt_esq+1
        else:
            return alt_dir+1
        
    def contar_nos(self,no):
        if no is None:
            return 0
        else:
            cont_esq=self.contar_nos(no.esquerda)
            cont_dir=self.contar_nos(no.direita)
            return 1 + cont_esq + cont_dir

    def contar_folhas(self,no):
        if no is None:
            return 0
        if no.esquerda is None and no.direita is None:
            return 1
        else:
            folha_esq=self.contar_folhas(no.esquerda)
            folha_dir=self.contar_folhas(no.direita)
            return folha_esq +folha_dir
        
    def buscar(self,valor):
        atual=self.raiz
        while atual!=None:
            if valor==atual.dado:
                return True
            elif valor<atual.dado:
                atual=atual.esquerda
            else:
                atual=atual.direita
        return False

    def minimo(self,no):
        atual=no
        while atual.esquerda!=None:
            atual=atual.esquerda
        return atual.dado
    
    def maximo(self,no):
        atual=no
        while atual.direita!=None:
            atual=atual.direita
        return atual.dado
    
    def valores(self,no,lista):
        if no is None:
            return 
        lista.append(no.dado)
        self.valores(no.esquerda,lista)
        self.valores(no.direita,lista)

    def media(self,no):
        lista=[]
        self.valores(no,lista)
        return sum(lista)/len(lista)
    
    def contar_maiores(self,no,limite):
        lista=[]
        self.valores(no,lista)
        cont=0
        for i in lista:
            if i > limite:
                cont+=1
        return cont

    def pre_ordem(self,no):
        if no:
            print(no.dado)
            self.pre_ordem(no.esquerda)
            self.pre_ordem(no.direita)

    def em_ordem(self,no):
        if no:
            self.em_ordem(no.esquerda)
            print(no.dado)
            self.em_ordem(no.direita)

    def pos_ordem(self,no):
        if no:
            self.pos_ordem(no.esquerda)
            self.pos_ordem(no.direita)
            print(no.dado)

def menu():
    print("1-inserir")
    print("2-pre ordem")
    print("3-em ordem")
    print("4-pos ordem")
    print("5-altura")
    print("6-contar nos")
    print("7-contar folhas")
    print("8-buscar")
    print("9-minimo")
    print("10-maximo")
    print("11-media")
    print("12-maiores que um valor")
    print("13-sair")
    return int(input("digite uma opção: "))

def main():
    arv=Arvore()
    opc=0
    while opc !=13:
        opc=menu()
        if opc==1:
            v=int(input("valor: "))
            arv.inserir(v)
        elif opc==2:
            arv.pre_ordem(arv.raiz)
        elif opc==3:
            arv.em_ordem(arv.raiz)
        elif opc==4:
            arv.pos_ordem(arv.raiz)
        elif opc==5:
            print(arv.altura(arv.raiz))
        elif opc==6:
            print(arv.contar_nos(arv.raiz))
        elif opc==7:
            print(arv.contar_folhas(arv.raiz))
        elif opc==8:
            opc=int(input("digite o valor que quer procurar: "))
            print(arv.buscar(opc))
        elif opc==9:
            print(arv.minimo(arv.raiz))
        elif opc==10:
            print(arv.maximo(arv.raiz))
        elif opc==11:
            print(arv.media(arv.raiz))
        elif opc==12:
            v=int(input("qual é o valor limite: "))
            print(arv.contar_maiores(arv.raiz,v))
        elif opc==13:
            print("saindo...")

main()

